<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout Tracker</title>
    <link rel="stylesheet" href="{{url_for('static', filename='css/styles.css')}}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Onest:wght@100..900&display=swap" rel="stylesheet">
</head>
<body>
    <nav>
        <a href="/">Home</a>
        <a href="/graphs">Graphs</a>
        <a href="/progress">Progress Report</a>
        <a href="/weather">Weather</a>
    </nav>

    <h1>Workout Tracker</h1>
    <form id="workoutForm">
        <input type="text" id="workoutName" placeholder="Workout Name" required>
        <input type="number" id="steps" placeholder="Steps Taken" required>
        <input type="number" id="heartRate" placeholder="Heart Rate" required>
        <input type="number" id="caloriesBurned" placeholder="Calories Burned" required>
        <input type="number" id="distanceWalked" placeholder="Distance Walked (km)" required>
        <button type="submit">Add Workout</button>
    </form>

    <h2 style="text-align: center;">Workout History</h2>
    <ul id="workoutHistory" style="text-align: center; list-style-type: none;"></ul>

    <p style="text-align: center;">made by yajath b and powered by JavaScript, localStorage, and other cool stuff</p>

    <script>
        // Generate or get user ID from localStorage
        function getUserId() {
            let userId = localStorage.getItem('userId');
            if (!userId) {
                // Generate a random userId if it doesn't exist
                userId = 'user_' + Math.floor(Math.random() * 1000000);
                localStorage.setItem('userId', userId);
            }
            return userId;
        }

        // Save workout data to localStorage for the specific user
        function saveWorkoutData(workoutName, steps, heartRate, calories, distance) {
            const userId = getUserId(); // Get user ID

            let progressData = JSON.parse(localStorage.getItem(userId)) || [];

            // Create a new workout object
            const newWorkout = {
                workoutName: workoutName,
                steps: steps,
                heartRate: heartRate,
                calories: calories,
                distance: distance,
                date: new Date().toLocaleString()
            };

            // Add new workout to existing data
            progressData.push(newWorkout);

            // Save the updated progress data back to localStorage
            localStorage.setItem(userId, JSON.stringify(progressData));
        }

        // Load and display workout history from localStorage
        function loadWorkoutHistory() {
            const userId = getUserId(); // Get user ID
            const progressData = JSON.parse(localStorage.getItem(userId)) || [];

            const workoutHistoryContainer = document.getElementById('workoutHistory');
            workoutHistoryContainer.innerHTML = ''; // Clear previous history

            progressData.forEach((workout) => {
                const workoutItem = document.createElement('li');
                workoutItem.textContent = `${workout.date} - ${workout.workoutName}: ${workout.steps} steps`;
                workoutHistoryContainer.appendChild(workoutItem);
            });
        }

        // Form submit event listener
        document.getElementById('workoutForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form submission

            const workoutName = document.getElementById('workoutName').value;
            const steps = document.getElementById('steps').value;
            const heartRate = document.getElementById('heartRate').value;
            const calories = document.getElementById('caloriesBurned').value;
            const distance = document.getElementById('distanceWalked').value;

            // Save the workout data to localStorage
            saveWorkoutData(workoutName, steps, heartRate, calories, distance);

            // Reload the workout history
            loadWorkoutHistory();
        });

        // Load workout history when the page loads
        window.onload = loadWorkoutHistory;
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    <script type="text/javascript">
        function googleTranslateElementInit() {
          new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
        }
        </script>
    <div id="google_translate_element"></div>
</body>
</html>
